{"changed":true,"filter":false,"title":"comments_controller.rb","tooltip":"/app/controllers/comments_controller.rb","value":"class CommentsController < ApplicationController\n  respond_to :html, :js\n\n  def create\n    @topic = Topic.find(params[:topic_id])\n    @post = @topic.posts.find(params[:post_id])\n    @comments = @post.comments\n    \n    @comment = current_user.comments.build(params.require(:comment).permit(:body, :post_id))\n    @comment.post = @post\n    @new_comment = Comment.new\n\n    authorize @comment\n\n    if @comment.save\n      flash[:notice] = \"Comment was created.\"\n    else\n      flash[:error] = \"There was an error saving the comment. Please try again.\"\n    end\n\n    respond_with(@comment) do |f|\n      f.html { redirect_to [@topic, @post] }\n    end\n  end\n\n  def destroy\n    @topic = Topic.find(params[:topic_id])\n    @post = @topic.posts.find(params[:post_id])\n\n    @comment = @post.comments.find(params[:id])\n    authorize @comment\n\n    if @comment.destroy\n      flash[:notice] = \"Comment was deleted.\"\n    else\n      flash[:error] = \"Comment could not be deleted. Try again.\"\n    end\n\n    respond_with(@comment) do |f|\n      f.html { redirect_to [@topic, @post] }\n    end\n  end\nend\n","undoManager":{"mark":-2,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":0,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1427698852000}